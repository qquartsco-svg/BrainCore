# 상태계 중심 구조 구현 계획

**작성일**: 2026-02-20  
**목적**: "수액이 흐르는 생명체"로 진화

---

## 1. 현재 상태

### 완성된 것 ✅

- 아키텍처 설계: 9/10
- 인터페이스 철학: 9/10
- 확장 준비도: 8/10

### 부족한 것 ❌

- 실제 통합 밀도: 5/10
- 상태계 완성도: 4/10

**전체 체감**: 7/10

---

## 2. 구현 계획

### Phase 1: GlobalState 정의 ✅ (완료)

**작업**:
- [x] `GlobalState` 클래스 구현
- [x] 공통 상태 벡터 정의
- [x] L0, L1, L2 관련 필드 정의

**파일**: `src/brain_core/global_state.py`

---

### Phase 2: 엔진 인터페이스 변경 ⚠️ (진행 중)

**작업**:
- [ ] `StateCentricEngine` Protocol 정의
- [ ] 각 엔진에 `update(state: GlobalState) -> GlobalState` 구현
- [ ] 기존 인터페이스와 병행 운영

**우선순위**: 높음

---

### Phase 3: L0 중심 재정렬 ⚠️ (진행 중)

**작업**:
- [ ] L0를 중심으로 엔진 순서 재정렬
- [ ] WellFormation → L0 초기화기로 재정의
- [ ] StateManifold → L0 제약 조건 생성기로 재정의
- [ ] Historical → L0 상태 기록기로 재정의
- [ ] Cingulate → L0 안정성 모니터로 재정의

**우선순위**: 높음

---

### Phase 4: 상태계 중심 실행 루프 ⚠️ (진행 중)

**작업**:
- [ ] `StateCentricExecutionLoop` 구현
- [ ] 엔진이 상태를 perturb하도록 변경
- [ ] 기존 `ExecutionLoop`와 병행 운영

**우선순위**: 중간

---

### Phase 5: 통합 테스트 ⚠️ (대기)

**작업**:
- [ ] 전체 파이프라인 테스트
- [ ] 성능 검증
- [ ] 문서화

**우선순위**: 낮음 (Phase 2-4 완료 후)

---

## 3. 구현 순서

### 즉시 작업 (우선순위 1)

1. **GlobalState 정의** ✅ (완료)
2. **StateCentricEngine Protocol 정의** ⚠️
3. **L0 중심 재정렬** ⚠️

### 단기 작업 (우선순위 2)

4. **엔진별 update() 구현** ⚠️
5. **상태계 중심 실행 루프** ⚠️

### 중기 작업 (우선순위 3)

6. **통합 테스트** ⚠️
7. **성능 최적화** ⚠️

---

## 4. 예상 효과

### Before (현재)

- 엔진별 다른 데이터 구조
- 복잡한 변환 로직
- 엔진 간 상호작용 어려움

### After (재설계 후)

- GlobalState (공통 상태)
- 단순한 상태 업데이트
- 엔진 간 자연스러운 상호작용

---

## 5. 진행률

- **Phase 1**: 100% ✅
- **Phase 2**: 0% ⚠️
- **Phase 3**: 0% ⚠️
- **Phase 4**: 0% ⚠️
- **Phase 5**: 0% ⚠️

**전체 진행률**: 약 20%

---

**작성자**: GNJz (Qquarts)  
**상태**: 구현 계획 수립 완료

